{% extends "main.html" %}
{% block headtitle %}{{ title }}{% endblock %}
{% block headnav %}
    <a class="btn btn-outline-primary" href="{{ url_for('edit', employee_id=employee.id) }}">Edit</a>
    <a class="btn btn-outline-primary" href="{{ url_for('home') }}">Home</a>
{% endblock %}
{% block body %}

<div class="row">
  <div class="col-md-12">
    <div class="row mb-3">
      <label class="col-sm-2 col-form-label">Full Name</label>
      <div class="col-sm-10">
        {{ employee.fullname }}
      </div>
    </div>
    <div class="row mb-3">
      <label class="col-sm-2 col-form-label">Location</label>
      <div class="col-sm-10">
        {{ employee.location }}
      </div>
    </div>
    <div class="row mb-3">
      <label class="col-sm-2 col-form-label">Job Title</label>
      <div class="col-sm-10">
        {{ employee.job_title }}
      </div>
    </div>
    <div class="row mb-3">
      <label class="col-sm-2 col-form-label">Badges</label>
      <div class="col-sm-10">
        <div id="badgesDisplay">
          {% for badge_key, badge_name in badges.items() %}
            {% if badge_key in employee.badges %}
              <span class="badge bg-primary me-2">
                <i class="fa fa-{{ badge_key }}"></i> {{ badge_name }}
              </span>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
    
    <div class="row mb-3">
      <div class="col-sm-10 offset-sm-2">
        <div class="d-grid gap-2 d-md-block">
          <form method="POST" action="{{ url_for('delete', employee_id=employee.id) }}" 
                style="display: inline;" 
                id="deleteForm"
                onsubmit="return confirmDelete(event)">
            <button type="submit" class="btn btn-danger" id="deleteBtn">
              <span class="btn-text">Delete Employee</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
function confirmDelete(event) {
  const confirmed = confirm('Are you sure you want to delete this employee?');
  if (confirmed) {
    const deleteBtn = document.getElementById('deleteBtn');
    const deleteForm = document.getElementById('deleteForm');
    
    // Show loading states
    LoadingManager.showButtonLoading(deleteBtn);
    LoadingManager.showFormLoading(deleteForm);
    
    // Add a small delay to show loading state
    setTimeout(() => {
      // Form will submit naturally
    }, 200);
    
    return true;
  }
  return false;
}

// Enhanced badge display with loading animation
document.addEventListener('DOMContentLoaded', function() {
  const badgesDisplay = document.getElementById('badgesDisplay');
  if (badgesDisplay) {
    const badges = badgesDisplay.querySelectorAll('.badge');
    badges.forEach((badge, index) => {
      badge.style.opacity = '0';
      badge.style.transform = 'translateY(10px)';
      badge.style.transition = 'all 0.3s ease';
      
      setTimeout(() => {
        badge.style.opacity = '1';
        badge.style.transform = 'translateY(0)';
      }, index * 100);
    });
  }
});
</script>
{% endblock %}
